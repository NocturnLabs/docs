---
title: OpenCode Autocode
description: Autonomous coding agent for implementing features from specifications.
---

# OpenCode Autocode

OpenCode Autocode is a powerful scaffolding and utility tool designed to create and manage safe, autonomous coding environments for the OpenCode ecosystem. It bridges the gap between high-level project specifications and actual code implementation by providing:

1.  **Project Scaffolding**: Automatically sets up the `.opencode` environment, `app_spec.md`, and configuration files.
2.  **Autonomous Iteration**: Integrates with the `auto-continue` workflow to implement features one by one.
3.  **Verbalized Sampling**: Uses a "Generator-Selector" architecture to brainstorm diverse implementation approaches before writing code, preventing mode collapse.
4.  **Regression Testing**: Ensures that new features don't break existing functionality through automated verification reuse.

## Installation

You can install OpenCode Autocode by building from source or installing it globally using Cargo.

### Method 1: Global Install (Recommended)

If you have Rust installed, the easiest way to install and keep it updated is via `cargo install`:

```bash
# From within the yumlabs-opencode-autocode directory
cargo install --path .
```

This will verify dependencies, compile the binary, and place it in your `$HOME/.cargo/bin` folder (which should be in your `$PATH`).

### Method 2: Build from Source

```bash
# Clone the repository
git clone https://github.com/yumlabs/yumlabs-opencode-autocode
cd yumlabs-opencode-autocode

# Build release binary
cargo build --release

# The binary will be available at ./target/release/opencode-autocode
# You may want to symlink it to your local bin
ln -s $(pwd)/target/release/opencode-autocode ~/.local/bin/opencode-autocode
```

## Getting Started

OpenCode Autocode offers flexible ways to initialize your project, depending on how much control you want over the initial specification.

### 1. Interactive Mode (Recommended)

The interactive TUI (Text User Interface) guides you through creating a specification.

```bash
opencode-autocode --interactive
# OR simply:
opencode-autocode
```

### 2. Quick Start (Default Spec)

If you want to start immediately with a standard web application template:

```bash
opencode-autocode --default
```

### 3. Custom Specification

If you already have a detailed `app_spec.md` prepared:

```bash
opencode-autocode --spec ./my-specs/finance-app.md
```

## Core Features

### Project Scaffolding
When you run `opencode-autocode`, it creates a structured environment for the autonomous agent:
- `app_spec.md`: The source of truth for your project requirements.
- `feature_list.json`: A tracked list of features to be implemented.
- `autocode.toml`: Configuration for models, paths, and behavior.
- `.opencode/`: Directory containing memory and state for the agent.

### Verbalized Sampling
To solve complex problems, a single LLM inference often falls into "mode collapse," repeating the same standard patterns. **Verbalized Sampling** overcomes this:
1.  **Generator**: Creates $N$ (default 10) distinct implementation approaches, ranging from "Conventional" to "Creative."
2.  **Selector**: A separate, reasoning-heavy model evaluates these approaches against your project context and picks the best one.
3.  **Cache**: Results are cached in `.vs-cache` to save time and tokens on subsequent runs.

### Regression Testing
As the agent iterates, it's crucial to ensure old features still work.
- The `feature_list.json` tracks the `verification_command` for every completed feature.
- You can run **Regression Checks** at any time to re-verify all passing features.

```bash
opencode-autocode regression-check
```

## Configuration

The `autocode.toml` file allows you to tune every aspect of the autonomous agent.

### Models
Define which LLMs are used for specific tasks.

| Key | Description | Default |
| :--- | :--- | :--- |
| `default` | General tasks and spec generation. | `opencode/big-pickle` |
| `autonomous` | The main coding agent model. | `opencode/grok-code` |
| `reasoning` | High-IQ model for planning (optional). | Same as autonomous |
| `enhancement` | Model used for self-improvement ideas. | `opencode/big-pickle` |

### Autonomous Settings
Control the loop behavior.

| Key | Description | Default |
| :--- | :--- | :--- |
| `max_iterations` | Max loops before stopping (0 = infinite). | `0` |
| `delay_between_sessions` | Seconds to wait between loops. | `5` |
| `auto_commit` | Git commit after every feature? | `true` |
| `session_timeout_minutes`| Max duration per session. | `60` |

### Verbalized Sampling
Tune the creativity of the generator.

| Key | Description | Default |
| :--- | :--- | :--- |
| `enabled` | Use verbalized sampling? | `true` |
| `num_approaches` | How many ideas to generate. | `10` |
| `cache_results` | Save approaches to disk? | `true` |
| `conventional_probability` | Range for standard solutions. | `[0.8, 0.9]` |
| `creative_probability` | Range for wild/novel solutions. | `[0.0, 0.2]` |

### MCP Tools
Prioritize the tools available to the agent.
- `priority_order`: List of tool names (e.g., `["mgrep", "chat-history"]`).
- `prefer_mgrep`: Use `mgrep` over `grep` for smarter code search (`true`).
- `use_sequential_thinking`: Enable advanced reasoning tool (`true`).

## App Specification Reference

When using `opencode-autocode --spec <FILE>`, your specification file must follow this XML-like structure to be correctly parsed and utilized by the autonomous agent.

```xml
<project_specification>
  <project_name>My App</project_name>

  <overview>
    High-level description of what the application does.
  </overview>

  <core_features>
    <feature priority="high">
      <name>User Auth</name>
      <description>Login and registration flow</description>
      <sub_features>
        - JWT Implementation
        - Password Hashing
      </sub_features>
    </feature>
    <!-- Add more features as needed -->
  </core_features>

  <technology_stack>
    <languages>Rust, TypeScript</languages>
    <frameworks>Axum, React</frameworks>
  </technology_stack>

  <success_criteria>
    - All tests pass
    - < 100ms response time
  </success_criteria>
</project_specification>
```

## Security Guide

OpenCode Autocode implements a "Sandbox-by-Policy" approach. While the agent runs locally, its capabilities are restricted to prevent accidental damage.

### 1. Allowlist (`scripts/security-allowlist.json`)
This file is generated in your project and controls which specific commands or paths are permitted if strict mode is enabled.
*   **Allowed Commands**: Explicit list of safe binaries (e.g., `cargo`, `npm`, `git`).
*   **Allowed Paths**: Directories the agent can write to (defaults to the project root).

### 2. Blocked Patterns
The `autocode.toml` file contains a hard-coded list of dangerous patterns that are blocked at the prompt level, regardless of the allowlist.
```toml
[security]
blocked_patterns = [
    "rm -rf /",
    "sudo",
    "chmod 777",
    "curl | bash"
]
```

## CLI Reference

### Commands

#### `templates`
Manage project templates.

```bash
# List available templates
opencode-autocode templates list

# Use a specific template
opencode-autocode templates use <NAME>
```

#### `edit`
Open the interactive TUI editor for the current project's spec.

```bash
opencode-autocode edit
```

#### `regression-check`
Validate that completed features still pass their tests.

```bash
# Check all passing features
opencode-autocode regression-check

# Check only "functional" category features
opencode-autocode regression-check --category functional

# Verify output with verbose logging
opencode-autocode regression-check --verbose
```

### Flags

| Flag | Description |
| :--- | :--- |
| `--dry-run` | Preview actions without creating files. |
| `--output <DIR>` | Specify target directory (default: `.`). |
| `--git-init` | Initialize a git repo after scaffolding. |
| `--config <FILE>` | Use a custom toml config file. |

### Usage Examples with Dry Run

**1. Previewing a default scaffold:**
```bash
$ opencode-autocode --default --dry-run
ğŸ” Dry run mode - no files will be created

ï¿½ Preview: Files that would be created
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Directories:
   ğŸ“ ./.opencode
   ğŸ“ ./.opencode/command
   ğŸ“ ./scripts

Files:
   ğŸ“„ ./app_spec.md
   ğŸ“„ ./.opencode/command/auto-init.md
   ğŸ“„ ./.opencode/command/auto-continue.md
   ğŸ“„ ./.opencode/command/auto-enhance.md
   ğŸ“„ ./scripts/run-autonomous.sh
   ğŸ“„ ./scripts/security-allowlist.json
   ğŸ“„ ./opencode-progress.txt

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total: 3 directories, 7 files
Run without --dry-run to create these files.
```

**2. Previewing a regression check:**
*Note: Regression checks require a real `feature_list.json` to exist, but won't modify files.*
```bash
$ opencode-autocode regression-check --verbose
ğŸ” Running regression check on feature_list.json...
Checking: User Authentication
  âœ“ PASS
Checking: Database Connection
  âœ“ PASS
Checking: API Rate Limiting
  â—‹ MANUAL (no verification_command)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       REGRESSION CHECK SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Total features:        3
Features checked:      3

Automated tests:
  âœ“ Passed:           2
  âœ— Failed:           0
  â—‹ Manual required:  1

âœ… All automated regression tests passed!
   Reminder: 1 features require manual verification.
```

**3. Listing Available Templates:**
```bash
$ opencode-autocode templates list

ğŸ“š Available Templates
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  ğŸŒ Full-Stack Web App (web-app-fullstack)
    React + Node.js/Express with SQLite

  ğŸ”§ CLI Tool (cli-tool)
    Rust CLI with clap, config file support

  ğŸ”Œ REST API (api-rest)
    Python/FastAPI with PostgreSQL

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Use: opencode-autocode templates use <name>
Or run with -i for interactive selection
```

**4. Viewing Help:**
```bash
$ opencode-autocode --help
Opencode Autocode 0.1.0
CodingInCarhartts
Scaffold autonomous coding plugin for OpenCode

Usage: opencode-autocode [OPTIONS] [COMMAND]

Commands:
  templates         Manage project templates
  edit              Launch interactive spec editor (TUI)
  regression-check  Run regression checks on feature_list.json
  help              Print this message or the help of the given subcommand(s)

Options:
  -d, --default          Use the default app spec template
  -s, --spec <FILE>      Path to a custom app spec file
  -i, --interactive      Launch interactive TUI to build app spec
  -o, --output <DIR>     Output directory for scaffolded files (default: current directory)
      --dry-run          Preview mode: show what files would be created without creating them
      --git-init         Initialize git repository after scaffolding
      --config <FILE>    Path to custom config file (default: autocode.toml in current directory)
  -h, --help             Print help
  -V, --version          Print version
```
